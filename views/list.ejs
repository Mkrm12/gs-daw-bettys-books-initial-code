<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to <%= shopData.shopName %></title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
      }

      h1, h2 {
        text-align: center;
        color: #333;
      }

      .movies-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 20px;
      }

      .movie-box {
        position: relative;
        background-color: #fff;
        border: 1px solid #ddd;
        padding: 16px;
        margin: 10px;
        width: 300px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .movie-box:hover {
        transform: translateY(-10px);
      }

      .movie-title {
        font-size: 1.6em;
        margin-bottom: 0.5em;
        color: #333;
      }

      .movie-details p {
        margin: 0.5em 0;
        color: #555;
      }

      .favorite-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #f39c12;
        color: white;
        border: none;
        padding: 8px 12px;
        font-size: 1em;
        cursor: pointer;
        border-radius: 5px;
        transition: background-color 0.3s ease;
      }

      .favorite-btn.favorited {
        background-color: #e74c3c;
      }

      .favorite-btn:hover {
        background-color: #e67e22;
      }

      .review-section {
        margin-top: 1em;
      }

      .review-box {
        border-top: 1px solid #ccc;
        padding-top: 1em;
        margin-top: 1em;
        background-color: #f9f9f9;
        border-radius: 8px;
        padding: 10px;
      }

      .review-box h4 {
        font-size: 1.2em;
        margin-bottom: 0.5em;
        color: #333;
      }

      .review-item {
        margin-bottom: 1em;
        padding: 10px;
        background-color: #e7e7e7;
        border-radius: 5px;
      }

      .review-item strong {
        font-weight: bold;
        font-size: 1.1em;
      }

      .rating {
        color: #f39c12;
      }

      input[type="number"] {
        padding: 5px;
        font-size: 1em;
        margin-bottom: 10px;
        width: 60px;
      }

      textarea {
        width: 100%;
        padding: 8px;
        border-radius: 5px;
      }

      .favorited {
        background-color: #ffcccb;
      }
    </style>
 <head>
  <title><%= shopData.shopName %> - Movie Shop</title>
</head>



<body>
  <h1><%= shopData.shopName %> Shop</h1>
  <h2>Here are the movies that we offer:</h2>
  <p><strong>Welcome <%= firstName %>, User ID: <%= userId %></strong></p>

  <div class="movies-container">
      <% availableMovies.forEach(movie => { %>
      <div class="movie-box" id="movie-<%= movie.id %>">
          <h3 class="movie-title"><%= movie.title %></h3>
          <div class="movie-details">
              <p><strong>Release Date:</strong> <%= movie.release_date %></p>
              <p><strong>Description:</strong> <%= movie.description %></p>
              <p>Rating: <%= movie.rating || 'No Rating Yet' %></p>
          </div>

          <!-- Favorite/Unfavorite Button -->
          <div class="favorite-box">
              <% if (userId && firstName) { %>
                  <form method="POST" action="/movies/<%= movie.isFavorited ? 'unfavorite' : 'favorite' %>">
                      <input type="hidden" name="movieId" value="<%= movie.id %>">
                      <button type="submit">
                          <%= movie.isFavorited ? 'Unfavorite' : 'Favorite' %>
                      </button>
                  </form>
              <% } else { %>
                  <p class="error-msg">You must <a href="/users/login">log in</a> to favorite this movie.</p>
              <% } %>
          </div>

          <!-- Reviews Section -->
          <div class="review-section">
              <h4>Reviews:</h4>
              <% if (movie.reviews && movie.reviews.length > 0) { %>
                  <% movie.reviews.forEach(review => { %>
                      <div class="review-item">
                          <strong><%= review.userName %>:</strong>
                          <p><%= review.comment %></p>
                          <span class="rating">Rating: <%= review.rating %></span>
                      </div>
                  <% }); %>
              <% } else { %>
                  <p>No reviews yet.</p>
              <% } %>
          </div>

          <!-- Leave a Review -->
          <div class="review-box">
              <% if (userId && firstName) { %>
                  <form method="POST" action="/movies/review">
                      <input type="hidden" name="movieId" value="<%= movie.id %>" />
                      <input type="hidden" name="userId" value="<%= userId %>" />
                      <input type="hidden" name="username" value="<%= firstName %>" />

                      <label for="rating">Rating:</label>
                      <input type="number" name="rating" step="0.1" min="0" max="10" required><br />

                      <label for="comment">Comment:</label><br />
                      <textarea name="comment" rows="4" cols="40" required></textarea><br />
                      <button type="submit">Submit Review</button>
                  </form>
              <% } else { %>
                  <p class="error-msg">Please <a href="/users/login">log in</a> to leave a review.</p>
              <% } %>
          </div>
      </div>
      <% }) %>
  </div>

  <footer>
      <p>Thank you for visiting <%= shopData.shopName %>!</p>
      <p>Want to go back? <a href="/">Home</a></p>
  </footer>
</body>





</html>
